[info] tensorboard integration:
tensorboard --logdir 'C:/DATA/data/processed/p12_std_hosp/'
[Info] parameters: Namespace(data='C:/DATA/data/processed/p12_std_hosp/', data_label='multilabel', cuda=False, wandb=True, per=50, balanced_batch=True, transfer_learning='', freeze='', log='log.txt', user_prefix='[bal]TEDA__shpmark-', pos_alpha=1.0, epoch=30, batch_size=8, lr=0.00245, smooth=0.0, event_enc=1, time_enc='concat', te_d_mark=8, te_d_time=8, te_d_rnn=256, te_d_inner=16, te_d_k=8, te_d_v=8, te_n_head=4, te_n_layers=4, te_dropout=0.1, state=True, demo=False, num_states=1, w_sample_label=100.0, mod='single', int_dec='sahp', w_event=1, next_mark=1, w_class=False, w_pos=True, mark_detach=0, w_time=1.0, sample_label=0, hparams2write={'data': 'C:/DATA/data/processed/p12_std_hosp/', 'data_label': 'multilabel', 'cuda': False, 'wandb': True, 'per': 50, 'balanced_batch': True, 'transfer_learning': '', 'freeze': '', 'log': 'log.txt', 'user_prefix': '[bal]TEDA__shpmark-', 'pos_alpha': 1.0, 'epoch': 30, 'batch_size': 8, 'lr': 0.00245, 'smooth': 0.0, 'event_enc': 1, 'time_enc': 'concat', 'te_d_mark': 8, 'te_d_time': 8, 'te_d_rnn': 256, 'te_d_inner': 16, 'te_d_k': 8, 'te_d_v': 8, 'te_n_head': 4, 'te_n_layers': 4, 'te_dropout': 0.1, 'state': True, 'demo': False, 'num_states': 1, 'w_sample_label': 100.0, 'mod': 'single', 'int_dec': 'sahp', 'w_event': 1, 'next_mark': 1, 'w_class': False, 'w_pos': True, 'mark_detach': 0, 'w_time': 1.0, 'sample_label': 0}, date='29-12-22--14-25-53', run_id='1035195', str_config='-single-state1-per50', run_name='[bal]TEDA__shpmark-1035195-single-state1-per50', run_folder='C:/DATA/data/processed/p12_std_hosp/[bal]TEDA__shpmark-1035195-single-state1-per50/', writer=<torch.utils.tensorboard.writer.SummaryWriter object at 0x000002680D1C7460>, device=device(type='cpu'))
[Info] Loading train data...
[Info] Loading dev data...
[Info] Loading test data...
[Info] Loading train STATE...
[Info] Loading dev STATE...
[Info] Loading test STATE...
Traceback (most recent call last):
  File "C:\DATA\Tasks\220702\codes\thp_final\Main.py", line 1413, in <module>
    main()
  File "C:\DATA\Tasks\220702\codes\thp_final\Main.py", line 1308, in main
    opt = config(opt)
  File "C:\DATA\Tasks\220702\codes\thp_final\Main.py", line 968, in config
    opt.trainloader, opt.testloader, additional_info = prepare_dataloader(opt)
  File "C:\DATA\Tasks\220702\codes\thp_final\Main.py", line 221, in prepare_dataloader
    trainloader = get_dataloader3(train_data, data_state=train_state, bs=opt.batch_size, shuffle=True, data_label=opt.data_label, balanced=opt.balanced_batch, state_args=state_args)
  File "C:\DATA\Tasks\220702\codes\thp_final\preprocess\Dataset.py", line 374, in get_dataloader3
    ds = TEDA(data_event, data_state,dim=dim, data_label=data_label,**state_args)
  File "C:\DATA\Tasks\220702\codes\thp_final\preprocess\Dataset.py", line 48, in __init__
    self.time_state = [[elem['abs_time'] for elem in inst] for inst in dict_state['state']]
KeyError: 'state'